<!DOCTYPE html>
<html>
	<div id="page">
		<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>R</title>


	<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
		  tex2jax: {
			skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			inlineMath: [['$','$']]
		  }
		});
	</script>
	<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

	<link rel="stylesheet" href="/libfolding/css/main.css">
	<link rel="canonical" href="http://localhost:4000/libfolding/R">

	<link href="https://fonts.googleapis.com/css?family=Francois+One|Didact+Gothic|Roboto|Roboto+Mono|Caveat|Kalam|Oswald|Muli|Open+Sans|Shadows+Into+Light|Lato" rel="stylesheet" type='text/css'>
	
	<link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
	<link rel="shortcut icon" type="image/png" href="/libfolding" >
</head> 

		<div class="homeleft" style="width: 100%;">
			<div class="top">
				<div class="logo">
						<div class="normal">F<left>T</left><line></line><right>T</right>U</div>
						<div class="sub">THE FOLDING TEST OF UNIMODALITY</div>
				</div>
			
				<div class="pagetitle">
					R
				</div>
			</div>
			<div class="content">
				<h2 id="introduction">Introduction</h2>

<p>The Folding Test of Unimodality remains a statistical tool, so making a <code class="language-c++ highlighter-rouge"><span class="n">R</span></code> implementation seemed relevant for us.</p>

<p>Our package <code class="language-c++ highlighter-rouge"><span class="n">Rfolding</span></code> has been published on <a href="https://cran.r-project.org/web/packages/Rfolding/index.html">CRAN</a> on september 2018. Henceforth developpers to get and use it more easily!</p>

<h2 id="installation">Installation</h2>

<h3 id="rstudio">RStudio</h3>

<p>Most of the <code class="language-c++ highlighter-rouge"><span class="n">R</span></code> developpers are likely to work with <a href="https://www.rstudio.com">RStudio</a>. Thanks to its toolbox you can quickly download the package.</p>

<div style="width: 100%; float: left; margin-bottom: 1em;">
<img src="assets/rstudio.png" alt="?" style="float: left; width:62%;" />
<img src="assets/rstudio2.png" alt="?" style="float: right; width:35%; border: solid; border-radius:5px; border-width: 1px; margin-top: 1em;" />
</div>

<h3 id="r-console">R console</h3>

<p>On R console you can also install it through the following command</p>
<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"Rfolding"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 id="getting-started">Getting started</h2>

<p>The <code class="language-c++ highlighter-rouge"><span class="n">R</span></code> package is quite lightweight but embeds everything to perform the FTU on a dataset. The main the function is the following:</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">folding.test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>It needs a $n\times d$ matrix ($n$ observations in dimension $d$) as input and returns 3 elements:</p>

<p>-<code class="language-c++ highlighter-rouge"><span class="n">unimodal</span></code> (TRUE or FALSE): the output of the test</p>

<p>-<code class="language-c++ highlighter-rouge"><span class="n">pvalue</span></code> (float): the significance of the test</p>

<p>-<code class="language-c++ highlighter-rouge"><span class="n">Phi</span></code> (float): the folding statistics</p>

<p>A basic example is given below</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="c1"># number of observations</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c1"># dimension</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="c1"># mean</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="c1"># covariance matrix</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvrnorm</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">Sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sigma</span><span class="p">)</span><span class="w"> </span><span class="c1"># Random sample from multivariate gaussian distribution</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folding.test</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> </span><span class="c1"># perform the test</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="c1"># output</span><span class="w">
</span><span class="o">$</span><span class="n">unimodal</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="kc">TRUE</span><span class="w">

</span><span class="o">$</span><span class="n">pvalue</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">0.0001220703</span><span class="w">

</span><span class="o">$</span><span class="n">Phi</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">3.07955</span><span class="w">
</span></code></pre></div></div>

<p>This function does everything but you can do the same thing step-by-step. First you can compute only the folding statistics</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folding.statistics</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Phi</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">3.07955</span><span class="w">
</span></code></pre></div></div>

<p>We naturally notice that $\Phi&gt;1$ so the distribution is rather unimodal (of course, it is drawn from the normal law!). Then, with $\Phi, n$ and $d$ we can compute the p-value:</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">pvalue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">folding.test.pvalue</span><span class="p">(</span><span class="n">Phi</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pvalue</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">0.0001220703</span><span class="w">
</span></code></pre></div></div>

<p>If you want to investigate deeper, you can also compute the folding pivot through the function <code class="language-c++ highlighter-rouge"><span class="n">pivot</span><span class="p">.</span><span class="n">approx</span></code>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pivot.approx</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">S</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">-0.022377052</span><span class="w">  </span><span class="m">0.036734302</span><span class="w">  </span><span class="m">0.009282583</span><span class="w">
</span></code></pre></div></div>

<p>In this case we notice that the pivot is quite close to the mode. This phenomenon commonly occurs in the unimodal case.</p>


			</div>
		</div>
		<div class="homeright">
			<li><a title="Home" href="/libfolding/">
	<i class="fas fa-home"></i></a>
</li>
<li><a href="/libfolding/unimodality-testing" 
	title="About FTU"
	style="position:relative;top:0;left:0; width:100%; height:100%; display:block;"><svg viewBox="-10 -20 120 120" preserveAspectRatio="xMidYMid meet" >
		<path fill="none" d=" 
            M 0.00,70.00
L 1.69,69.98
L 3.39,69.96
L 5.08,69.91
L 6.78,69.85
L 8.47,69.74
L 10.17,69.59
L 11.86,69.36
L 13.56,69.02
L 15.25,68.55
L 16.95,67.89
L 18.64,67.00
L 20.34,65.82
L 22.03,64.28
L 23.73,62.31
L 25.42,59.86
L 27.12,56.88
L 28.81,53.33
L 30.51,49.21
L 32.20,44.55
L 33.90,39.41
L 35.59,33.90
L 37.29,28.18
L 38.98,22.43
L 40.68,16.88
L 42.37,11.76
L 44.07,7.31
L 45.76,3.76
L 47.46,1.28
L 49.15,0.00
L 50.85,0.00
L 52.54,1.28
L 54.24,3.76
L 55.93,7.31
L 57.63,11.76
L 59.32,16.88
L 61.02,22.43
L 62.71,28.18
L 64.41,33.90
L 66.10,39.41
L 67.80,44.55
L 69.49,49.21
L 71.19,53.33
L 72.88,56.88
L 74.58,59.86
L 76.27,62.31
L 77.97,64.28
L 79.66,65.82
L 81.36,67.00
L 83.05,67.89
L 84.75,68.55
L 86.44,69.02
L 88.14,69.36
L 89.83,69.59
L 91.53,69.74
L 93.22,69.85
L 94.92,69.91
L 96.61,69.96
L 98.31,69.98
L 100.00,70.00
			"/>
</svg>
</a></li>

<li><a href="/libfolding/cpp" title="C++ library">
	C++</a></li>

<li><a href="/libfolding/python" title="Python3 wrapper">
	<i class="fab fa-python"></i></a></li>

<li><a href="/libfolding/R" title="R package" >
	R</a></li>

<li><a href="/libfolding/about" title="About" >
	&middot;&middot;&middot;</a></li>


		

		</div>
	</div>
</html>
